//: Playground - noun: a place where people can play

import Foundation

func bytes(from hex: String) -> [UInt8] {
	var bytes = [UInt8]()
	var cursor = hex.startIndex
	while cursor < hex.endIndex {
		let nextCursor = hex.index(cursor, offsetBy: 2)
		bytes.append(UInt8(hex[cursor..<nextCursor], radix: 16)!)
		cursor = nextCursor
	}
	return bytes
}

// Computer: Hello
let helloABytes = bytes(from: "1014456700000000000000000100000000000000")
let helloA = Packet(bytes: helloABytes)

var switcher = ConnectionState.switcher(interpreting: helloABytes)
let resp = switcher.constructKeepAlivePackets()
//resp.forEach { print($0.bytes.map{String($0, radix: 16)}.joined()) }
//let ir = resp.map {Packet(bytes: $0.bytes)}
//ir.first
//
//// Atem: Hello
//let helloC = Packet(bytes: bytes(from: "1014456700000000003100000200000100000000"))
//
//// Computer: Acknowledgement for Hello
//let helloCack = Packet(bytes: bytes(from: "800c45670000000000000000"))
//
//// Atem: (Repeat) Hello
//let helloAAck = Packet(bytes: bytes(from: "3014456700000000003100000200000100000000"))
//
//// Computer: Acknowledgement for Hello
//Packet(bytes: bytes(from: "800c45670000000000000000"))
//
//// Atem:
//Packet(bytes: bytes(from: "0d8480010000000000000001000c00005f7665720002000d003400005f70696e4154454d2031204d2f452050726f64756374696f6e2053747564696f20344b00000000000000000005000000001400005f746f70011f02030201010001000000000c00005f4d654300040000000c00005f6d706c20020000000c00005f4d7643010a0101000c00005f414d430e010000000c00005f564d430003ffff000c0000506f777201000000000c00005669644d06000000002c0000496e50720000426c61636b000000000000000000000000000000426c6b0001000100010013010000002c0000496e5072000143616d657261203100000000000000000000000043616d3100030002000013010100002c0000496e5072000243616d657261203200000000000000000000000043616d3200010001000013010100002c0000496e5072000343616d657261203300000000000000000000000043616d3300010001000013010100002c0000496e5072000443616d657261203400000000000000000000000043616d3400010001000013010100002c0000496e5072000543616d657261203500000000000000000000000043616d3500010001000013010100002c0000496e5072000643616d657261203600000000000000000000000043616d3600010001000013010100002c0000496e5072000743616d657261203700000000000000000000000043616d3700010001000013010100002c0000496e5072000843616d657261203800000000000000000000000043616d3800010001000013010100002c0000496e5072000943616d657261203900000000000000000000000043616d3900010001000013010100002c0000496e5072000a43616d6572612031300000000000000000000000436d313000010001000013010100002c0000496e507203e8436f6c6f722042617273000000000000000000004261727300000100020013010100002c0000496e507207d1436f6c6f72203100000000000000000000000000436f6c3101000100030003010000002c0000496e507207d2436f6c6f72203200000000000000000000000000436f6c3201000100030003010000002c0000496e50720bc24d6564696120506c6179657220310000000000004d50310001000100040013010000002c0000496e50720bc34d6564696120506c617965722031204b657900004d50314b01000100050013010000002c0000496e50720bcc4d6564696120506c6179657220320000000000004d50320001000100040013010000002c0000496e50720bcd4d6564696120506c617965722032204b657900004d50324b01000100054f13010000002c7c4f496e50720faa4b65792031204d61736b000000000000010000004d314b310100010082c40300007e002ca821496e50720fb44b65792032204d61736b0060fccb4660148b08604d314b32010001008200030000c4002c3000496e50720fbe4b65792033204d61736b0060706c5760c49108604d314b330100010082c40300007e002ca821496e50720fc84b65792034204d61736b0060b4740d60a21e1d604d314b34010001008200030000c4002c0a00496e5072139244534b2031204d61736b0060bc20416030000000444b314d01000100820003000019002cffff496e5072139c44534b2032204d61736b0060b4740d60a21e1d60444b324d01000100827e03000000002ca200496e5072271a50726f6772616d00642a0060bc2041600a00000050726f6701000100800003000000002cbc20496e5072271b50726576696577001212121248211d60e01105605072657601000100801803000046002c6d61496e50721b59436c65616e2046656564203100495553434600264366643101000100806d03000030002c3131496e50721b5a436c65616e2046656564203200232323404523604366643201000100806c03000080"))

Packet(bytes: bytes(from: "080c80010000000000260001"))
0xFF00>>8
